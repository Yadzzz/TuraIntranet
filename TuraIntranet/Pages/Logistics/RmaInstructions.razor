@page "/rmainfo"

@inject PageNavigationService PageNavService
@inject NotificationService Notification
@inject Services.Logistics.RmaInformationService RmaService

<PageTitle>RMA Information</PageTitle>

<link rel="stylesheet" type="text/css" href="plugins/table/datatable/datatables.css">
<link rel="stylesheet" type="text/css" href="plugins/table/datatable/dt-global_style.css">
<link href="assets/css/components/tabs-accordian/custom-tabs.css" rel="stylesheet" type="text/css" />

<div id="content" class="main-content">
    <div class="layout-px-spacing">

        <div class="row layout-top-spacing" id="cancel-row">

            <div class="col-xl-4 col-lg-12 col-sm-12  layout-spacing">
                <div class="widget-content widget-content-area br-6">

                    <br />
                    <center><h5>RMA Information</h5></center>
                    <br />

                    <div class="form-group row" style="padding-left:25px;">
                        <div class="col-sm-11">
                            <input type="text" class="form-control form-control-sm" placeholder="Artikelnr" @bind-value=@articleNumberInput>
                        </div>

                        <div class="col-sm-11">
                            <input type="text" class="form-control form-control-sm" placeholder="EAN/UPC" @bind-value=@eanOrUpcInput>
                        </div>

                        <div class="col-xl-11 col-md-4">
                            <button class="btn btn-dark btn-block mb-4 mr-2" @onclick=@Search>Sök</button>
                        </div>
                    </div>
                </div>
            </div>

            @*@if (this.rmaData != null)*@
            @*{*@
            <div class="col-xl-8 col-lg-12 col-sm-12  layout-spacing">
                <div class="statbox widget box box-shadow">

                    <div class="widget-header">
                        <div class="row">
                            <div class="col-xl-12 col-md-12 col-sm-12 col-12">
                                <h4>INFO</h4>
                            </div>
                        </div>
                    </div>

                    <div class="widget-content widget-content-area vertical-line-pill">
                        <div class="row mb-4 mt-3">
                            <div class="col-sm-3 col-12">
                                <div class="nav flex-column nav-pills mb-sm-0 mb-3 text-center mx-auto" id="v-line-pills-tab" role="tablist" aria-orientation="vertical">
                                    <a class="nav-link active mb-3" id="v-line-pills-home-tab" data-toggle="pill" href="#v-line-pills-home" role="tab" aria-controls="v-line-pills-home" aria-selected="true">RMA</a>
                                    <a class="nav-link mb-3  text-center" id="v-line-pills-navision-tab" data-toggle="pill" href="#v-line-pills-navision" role="tab" aria-controls="v-line-pills-navision" aria-selected="false">Navision</a>
                                    <a class="nav-link mb-3  text-center" id="v-line-pills-astro-tab" data-toggle="pill" href="#v-line-pills-astro" role="tab" aria-controls="v-line-pills-astro" aria-selected="false">Astro</a>
                                </div>
                            </div>

                            <div class="col-sm-9 col-12">
                                <div class="tab-content" id="v-line-pills-tabContent">
                                    <div class="tab-pane fade show active" id="v-line-pills-home" role="tabpanel" aria-labelledby="v-line-pills-home-tab">
                                        <div class="media">
                                            <img class="mr-3 rounded-circle" src="assets/img/90x90.jpg" alt="Generic placeholder image">
                                            <div class="media-body">
                                                <h5 class="mt-0">ITEMNAME</h5>
                                                ITEMINFO
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="v-line-pills-navision" role="tabpanel" aria-labelledby="v-line-pills-navision-tab">

                                        <h4 class="mb-4">Navision Data</h4>
                                        <p class="mb-4">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
                                        </p>

                                        <p>
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
                                        </p>

                                    </div>
                                    <div class="tab-pane fade" id="v-line-pills-astro" role="tabpanel" aria-labelledby="v-line-pills-astro-tab">
                                        <h4 class="mb-4">Astro Data</h4>
                                        <p class="mb-4">
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
                                        </p>

                                        <p>
                                            Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            @*}*@

        </div>
    </div>
    <Footer />
</div>

@code {
    private string articleNumberInput = string.Empty;
    private string eanOrUpcInput = string.Empty;

    private Data.Logistics.Rma.RmaData? rmaData;

    protected override void OnInitialized()
    {
        this.PageNavService.UpdateActiveSection("Logistik");
        this.PageNavService.UpdateActivePage("RmaInformation");
    }

    private async Task Search()
    {
        rmaData = null;

        if (string.IsNullOrEmpty(this.articleNumberInput))
        {
            this.rmaData = await this.RmaService.GetRmaInformationAsync(this.articleNumberInput, "id");

            if (this.rmaData == null)
            {
                await this.Notification.AlertError("Kunde inte hitta Id [" + this.articleNumberInput + "]");
            }
        }
        else if (string.IsNullOrEmpty(this.eanOrUpcInput))
        {
            this.rmaData = await this.RmaService.GetRmaInformationAsync(this.eanOrUpcInput, "code");

            if (this.rmaData == null)
            {
                await this.Notification.AlertError("Kunde inte hitta EAN/UPC [" + this.eanOrUpcInput + "]");
            }
        }
        else
        {
            await this.Notification.AlertError("Mata in Id eller EAN/UPC");
            return;
        }

        this.StateHasChanged();
    }
}